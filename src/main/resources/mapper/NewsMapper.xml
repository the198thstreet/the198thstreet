<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="NewsMapper">
    <!--
        중복 제목을 피하기 위해 기존 레코드 존재 여부를 카운팅하는 단순 조회 쿼리.
        다른 컬럼은 조건에 포함하지 않고, 제목만 동일하면 중복으로 간주한다.
    -->
    <select id="countByTitle" parameterType="string" resultType="int">
        SELECT COUNT(1)
        FROM news_articles
        WHERE title = #{title}
    </select>

    <!--
        외부 API에서 받아온 뉴스를 저장한다.
        쿼리 파라미터(query, sort, start_pos, display_count)를 함께 남겨두어
        어느 검색 조건에서 저장된 데이터인지 추적할 수 있게 한다.
    -->
    <insert id="insertNewsItem" parameterType="map">
        INSERT INTO news_articles (
            title,
            originallink,
            link,
            description,
            pub_date,
            query,
            sort,
            start_pos,
            display_count
        ) VALUES (
            #{title},
            #{originallink},
            #{link},
            #{description},
            #{pubDate},
            #{query},
            #{sort},
            #{start},
            #{display}
        )
    </insert>
</mapper>
